data Token = OpenBracket | CloseBracket | Num Integer | Operator Char deriving (Eq)

instance Show Token where
    show OpenBracket = "("
    show CloseBracket = ")"
    show (Num n) = show n
    show (Operator op) = [op]


ex :: String
ex ="-999992698/-999991558+-999990587/-999992725--999990235--999997490/(-999999314*-999995543*-999999133*-999996566*(-999999957--999992906)*-999998359)+-999993158*-999996223--999996423*-999997630--999998483*(-999998815+-999998013*-999992803+-999998490*-999996008+-999997187+-999994256)+-999996623--999991593+-999995592--999990109--999995015*-999996176--999997655*-999994600*-999999626*(-999998074*-999991611)-(-999994461+-999991693--999997667/-999995821/-999992356+-999998211)--999998214/-999990101*-999991659+(-999995498/-999996769)--999990399/-999992880/-999998475+(-999997798/-999992977/-999999671)/-999993288--999994639--999994601*-999998089+-999999040/-999997266*-999995840/-999995667--999994857--999994322-(-999998365/-999995456+-999995542)*(-999999484*-999997293*-999996297)--999997159/-999997275/-999993706--999994313/-999990319*-999993158*(-999992680-(-999994012*-999990721)+-999999850*-999998856)+(-999999977--999995727*-999999601+-999996870*-999991931/-999994851+-999992391/-999990211)+(-999999749-(-999992789--999999615/(-999995281*-999999602/(-999999084--999991191)/(-999992005-(-999994321+(-999998265*-999995453+(-999991159--999993645)--999996295*(-999994538/(-999997925/-999992087)--999996787)-(-999994019/-999994731*-999994571--999999652--999999443)-(-999993016*-999992014)*(-999994715/-999992869)-(-999992543+-999995654)--999998169/-999997424)--999999935*-999991083--999999286)*-999994861--999990086)*(-999990733--999999841/-999993985)*-999996131)+-999991303--999991713)--999997302+(-999991814+(-999991753/-999991218)+-999995821*-999996073+-999996082)--999993819)*(-999991195-(-999992801-(-999996543+-999994678)/(-999992861+-999997405)-(-999992701+-999997874*-999994851*-999991300)--999990163)+-999990185+-999990671+-999997968)--999993672+-999999774*-999991478/-999995574*-999993323--999994455*-999995225/-999991542--999992955+-999999305/-999994773+-999997702+-999998745+-999992685--999997443/-999999914--999997026--999996239-(-999995091*-999996471/-999990031)/-999999030--999997440+(-999993007+-999995772+-999990029)--999997964--999990686/-999999141--999994333/-999992087*-999991345*(-999990557*(-999992492--999999848+-999992073*(-999997175+-999992237*(-999997307--999998902/(-999995166*-999996683)+-999998605-(-999993695*(-999991819/-999998836)+-999997344+(-999993999/-999991252)--999995531--999995581)*(-999997067*(-999990045/-999999080+-999996747+(-999999274--999999909)+-999998656+-999997123/-999993170/-999991560*-999998836*-999990543)--999993412+(-999994557+-999999274-(-999993418*-999993773)--999995964*-999996782+-999991026--999992838)/-999991996)+-999991762)*-999994407)+-999998424*-999994912--999994956+(-999994184*-999991230+(-999998829+-999998770*-999993153-(-999997918--999998480*-999997187*-999999004*-999993043+-999990056)*(-999994903--999999147*-999998974+-999990673/-999999900)--999992773)+(-999998677*-999995569*-999994721*(-999993499+-999994798/-999996202)*-999998084/(-999999157*(-999994000*-999995766*-999998944+-999998712/-999995780--999996412/-999999733--999996021--999990175+(-999994384*-999991468+(-999993275*(-999991894/(-999993423--999996704/-999992645--999999118-(-999990677+-999990543)*(-999992652+-999996490/-999991732+-999991074)--999996366+-999990505)/-999990311)+-999992387/(-999998659*-999995484+-999990352*-999998785)/-999995283--999991126)*(-999992665+(-999992582*-999997963--999999213--999994675+-999997627)+-999999894)+-999996513)+-999992389--999990753--999991749)/-999990352*-999998751)/-999992521)/-999999766+-999994007*-999993558*-999997414+-999998734+-999999447)-(-999994594--999996421*-999994310/-999993456+-999990047/-999999881*-999999356)/-999996683+-999992901--999990583/-999991992*-999992024+-999994284*(-999998945+-999996678)+-999994252)--999995705)--999991524*(-999999304-(-999992713/-999995604+-999993645*-999992382*-999999099--999994800)+-999998553+-999995412--999991217/(-999990717/-999998157)*-999994603)*(-999993760+-999991774/-999992193--999992609*-999994604+-999993920*-999994015+(-999992751*-999999213/-999992957)*-999991830*-999996126*-999993995--999993835*-999991535*-999991423--999994920)+-999992014*(-999996267/-999999136/-999991388)*(-999997011*-999996410/-999993684--999992059--999993561/-999990500*-999998880--999994130--999997981/-999993503)+(-999995963/-999992627)+-999999405/-999991641/-999996916*(-999991212+-999993043)/-999994071/-999993368+-999994451/-999997658--999999737--999993116-(-999998074*-999999407)/-999990668--999994305+-999991442/-999994847*-999995065+-999990460--999999923/-999995596--999998569--999996336*-999997363-(-999993834/-999994994/(-999995572/-999991700)+-999994521+-999999370)--999998428*-999994906*(-999997009--999995743+(-999991244--999997227*-999993935)+-999996316*-999995329+-999990597)+(-999992825*-999997244-(-999991699+-999998838)+-999999964*-999991046+-999997253-(-999990668+(-999998895+-999990757*-999997562*-999991195--999990668*-999993034)/(-999990627+-999993602--999993341)+-999996686/-999998962-(-999997543*-999995553*-999996345*(-999998150+-999994129-(-999996749*-999997282)+(-999990784-(-999994789+(-999991289*(-999999339+-999994790/(-999997961/-999995243)/-999992286+-999991551)+-999998333)--999999442-(-999992109/-999995712+-999992761*-999992064)/-999997724*-999997201)--999991327*-999997231--999992614*(-999995257*-999997079/-999995342)/-999999942)+-999991327/-999997178*-999991165--999990084-(-999991055/-999999040/-999998045)*-999998079*-999994325/-999998970)*-999991838--999991237--999995423*-999993805--999991685+(-999992199--999994880+-999991347)--999996412--999997833+-999995127)/(-999992285+-999996324+-999999994/-999991039)+(-999993495*-999992173)*(-999991438+-999997351--999993953/-999998490)--999993233+-999999767/-999991546--999993413+-999992167*-999990630+-999993047)+-999990091*-999990094--999991781/-999992758)/(-999994127+-999992084--999998298)--999991477/(-999996815/-999999459/-999998337/(-999998976*-999999755-(-999996765/-999994749+(-999998352/-999993078+-999995488)+-999995684)*(-999991838/-999993075+-999993406+-999993413/(-999999844--999999965*-999994921-(-999990601--999993943*-999990987*-999999626)+-999993938+-999992583*-999999237/-999997376*-999990080*-999999599)--999996044--999990369*-999991398)--999992152)/-999999214+-999998596)/(-999997865--999999973)*-999991230+-999996751*-999997128/-999993420*-999996325*-999997977/(-999991292/(-999995355/-999993438)/(-999993291/-999995986)--999999022/-999995017)+-999990097/(-999994574*-999992576/-999990871--999998002+-999990971/-999990457/-999997225*-999993862)+(-999993037*-999994363)--999993525+(-999998603*-999993924--999995519/-999998393*-999990332+-999994438*-999997290*-999990312+-999999376+-999995540+-999996704)*-999999122--999995103/-999996702--999995364-(-999994189+(-999995709--999992575+(-999998286/-999999835)-(-999992049--999997607+-999996695)*-999995290/(-999995368*-999997969+-999994066+-999991592+-999991704--999995305/-999996324)*-999998615+-999991807/-999995311/-999990558/-999990834)/-999990075--999996809+-999992356)*-999995032--999996359/-999995975-(-999999372--999995046)+-999993087/-999990560-(-999991774--999997649/(-999993953+-999995743)*-999996763+-999991515)--999994608*(-999996980/-999995632)*-999994835*-999997828-(-999995865--999993862+-999996028)/(-999990678/-999999637/-999992790)*-999992007*-999997827/-999990430+-999998220*-999993472*-999995265*-999990795--999993339-(-999990514+-999999318+-999998711)+(-999997539--999994166+-999992516*-999996138/-999994567+-999991541--999997640+(-999991665+-999999102)--999991616)*-999999816+-999990035+(-999994093+-999997472+-999997563*-999992458)/-999997807--999991697+-999993075-(-999990772/(-999991018+-999995685*(-999996049+-999995899--999997186*-999994661/(-999999413/-999999124)*-999998300)--999995889*-999990458)*(-999994611/(-999997952/-999992700/-999990598--999997176)+-999997307)/-999993512)/-999996532/-999991937/(-999998447+-999999126)--999990805/-999990217/(-999999817/-999994206-(-999995130+(-999991964*(-999997576--999997024+-999997257+-999991500)+-999992290)/-999991356--999997441+-999999381*-999998360*(-999992277*-999999441+(-999997298-(-999996941*-999991861)--999999102)--999991918)*-999991063--999998055)+-999993996)/-999993966+(-999992113--999998039)*-999998046/-999990156+(-999993025+-999992117--999994268+-999993646/(-999996824/-999993068)/-999997772*-999990708)+-999991012+-999999623*(-999992714+-999997097)--999995796*-999999902--999995124--999997103/-999997390*-999994817+-999994948+-999991344+-999991726+-999992177-(-999990413+-999996217*-999990183--999993776/-999991198*-999995759*-999992246/(-999993323/-999997013)--999993049--999996531*-999995157)--999999067/(-999994815*-999999976)+-999996760+-999992884/-999992582--999999400+-999995944*-999997256+-999999313*-999991457/-999994680*-999991426/(-999999633*-999992273--999991679-(-999995108*-999992480*-999994916--999995006)+-999997198/-999993250)+-999994416/(-999995369/-999995084-(-999999402/-999995883*(-999993868/-999999339/(-999992852+-999999648/-999996641--999996509)+-999998921)/(-999994976--999999449-(-999996053+-999995469*-999995173)*-999999997)--999999252)*(-999995239+-999997974)--999992418+(-999999905--999997385)+-999998060+-999998678*-999993936-(-999990929*-999998833/-999997340)/-999990592)--999999310+-999990457/(-999990929--999992283)-(-999998585*(-999995882+(-999990291-(-999990993*(-999992210+-999991357+-999999262/-999997575*-999991573+-999996708--999998559--999996132)--999992478)+-999995184)--999990654*-999994049+-999999096*-999994926)*-999990415*-999991112)*-999999791+-999999332/-999999601+(-999992139-(-999997146/-999991337+-999990973/-999991093/-999995761/(-999991560-(-999992813+-999996687)+(-999994019--999999815*-999999240-(-999999892/(-999998157*(-999999324*-999992421/-999997358)-(-999996272/-999995086+-999994750/-999993968*-999999167*-999994955/-999991450)*-999992431)/-999996390)-(-999999429+-999997015)*-999991728)*-999994593-(-999999272--999990071*-999991520--999992070/-999991700)/-999995410+-999999285--999998702/-999994301/-999992158)/-999991984--999994767)*-999990403)+-999996996--999991792/-999990133+-999999244/-999991386+(-999995620/-999995537)--999994540+-999998151-(-999993870/(-999999897+-999993338)-(-999993853/-999997449)*-999999711-(-999992500/(-999996283+-999995274)-(-999991431/(-999996589/-999990666/-999990606/-999997353--999991797)-(-999990407*-999996726)*-999997160)--999993026)--999991625--999996243+-999996950+-999993206/(-999992668/-999999095/-999999313*-999997871--999993697*-999999695)+-999992762-(-999997745--999990678)*-999996327/-999991194+-999991856--999997806)+-999995496+-999997358/-999990125+(-999999414*-999993633*-999993000-(-999993210/-999999155)+-999996211)+(-999994018/-999999324)*(-999998539*-999999204)-(-999994274--999999230/-999998412)/-999999555*-999992975-(-999998458/-999993379)+-999999075/-999993331/-999997982+-999999265-(-999992324*-999998830)/-999996851*-999996049/(-999996467*(-999990364*-999991615)+-999991289/-999995334)+-999998205+(-999997723*-999996233/-999996016+-999992446+(-999994785+-999992453*-999994331/-999997969)--999991113)+(-999998829+-999999623*-999993619)*-999995621/-999997127/(-999990547+-999995391+-999993506+-999995150+-999992349)/(-999991101*-999993081)/-999995617--999995613*(-999996833-(-999992008+(-999992290*-999994163)+-999992467/-999997511+-999990880-(-999994874--999993525/-999993913*-999997966+-999991360)/-999992840--999994752*-999992050)-(-999993532+(-999992238--999999638+-999995436*-999991879/-999998975)+-999994119-(-999994593+(-999993393+-999991882--999997761*-999996063-(-999996027--999997893)+-999998973+-999996573+-999998649)+-999992680--999993736)/(-999990844+-999993973*-999991922/-999997321+-999994010/-999994721+-999999052-(-999995381+-999997678--999998422)--999990860)--999995395/-999997813/-999993173+-999996812/-999992810*-999999923)/-999998975+(-999993461--999991649/-999993970)-(-999998972/(-999999273+-999994284/-999991306*-999999852+-999998719)*-999999170)+-999992106*-999996272--999993138*-999996047*(-999991681--999999322+-999998228)+(-999999891-(-999994171+(-999994441*-999995750/-999994039+-999998764/-999997391)*(-999991327/(-999997420/-999991694-(-999991417/(-999992658--999992066)*-999996323*-999995168--999996612)*-999993895*-999993381+-999991580--999996995)+-999991269/(-999995799+-999991197/-999999592*-999990734/(-999991522*-999992234+-999999081)+-999999106*(-999996029/-999991354*(-999997011/-999993394--999998948/-999991684/(-999992092*-999997089-(-999999323*(-999990718--999993333+-999997155)+-999995740--999994139--999997501)--999997701+-999993285)/-999990959)*-999995968--999996957)--999997316--999992581/(-999994949+-999993179+-999992768)*(-999994582+(-999999089*-999991536--999992932)+-999999384*-999990040+-999997942--999999881--999991492/-999999416--999995474*-999993134*-999997465-(-999991864+(-999998645*-999999766)+(-999990952/-999996814--999997828)/-999993635)/(-999996862+-999993309*-999995120+(-999997753+-999992772)--999995946/(-999994412*(-999991408/-999995171*-999994525/-999998292)*-999991341/-999990698--999991573/-999991572/-999991789*-999995981+-999991824/-999994622--999990559)--999995763)+-999997053)*(-999996035/-999997722+-999990683*-999995294--999995408+-999990207)*-999997702-(-999999166*(-999996936--999998634)*-999992759)/-999992047+-999990817/-999997824)/-999992682)+-999999546-(-999993344*-999997735)--999996032)*(-999990079*(-999998554--999990748)--999992270--999994671*-999996010)--999994215--999993727*-999991679)*-999990165)/-999994888--999994604+-999997093+-999999072+-999991452+(-999991956/-999990368/(-999996057--999993715--999994753--999991923--999997791+-999998903--999991558--999996881/-999990167)/-999993061)*(-999998569+-999997369+-999994982)+-999992942/-999990929/(-999990719/-999994220--999995430)+-999997095--999991601--999998064/-999995146/(-999996298--999996646)+-999997936-(-999995823/(-999993654-(-999998327--999997090+(-999994037-(-999993842+-999991199/-999990516+-999990255*-999997052)*-999993694-(-999994668--999998393)/-999992921)--999997243)+-999996081--999995356+-999992966/-999993428)+-999999565)*(-999996225*-999999033/-999995410)+(-999994984+-999993091/-999997068)*-999993042*-999992422/-999999835+(-999992034*-999992514)+-999998290*-999991606*-999993306/(-999990018+-999993544+(-999998695--999999925/-999990520)/-999994915--999991214*(-999998554--999994194--999995408)+-999993908--999991620/-999992946)+-999997196--999991320--999995683/(-999993760*-999999054/-999997376)*(-999997512*-999993107+-999992971)/-999994734--999999142+(-999995011+-999992536--999998023)+-999996701*-999996254/(-999997835-(-999997861+-999993698)*-999991876*-999999979*(-999996636*(-999998592*(-999998396/-999999888)+-999997716--999990801+(-999992652/(-999995287+(-999998623/-999995267*(-999993034+(-999990441-(-999991559/(-999993088--999996598)+-999996928*-999997520--999990619*-999998864+(-999998899/-999995651+-999998795)+-999995658*-999998616)--999992021*-999993325)--999998531)--999995378)/-999992173)*-999997875)+-999991006)--999997893+(-999999280+-999996599*(-999998542/(-999996969--999992728+-999992741*-999990605/-999993156)/-999990491)*-999993376*-999998101)*-999994998--999992650)/(-999995694+-999998689/-999999510)*-999993507)--999993296--999990823/-999994771--999993086--999994889/(-999996720/-999997969)+-999998227/-999992770+-999996547-(-999994246+(-999996908/-999991646+-999991049)/-999998681)+-999996055*-999994865+(-999996303--999997281)+-999994544+-999991544/-999994654+-999990382*-999994751+(-999990121+-999997233*-999999751*-999992963)*-999999824/-999991603*-999990335+-999997938+(-999999182/-999994485)*-999997143--999999837*-999999875+-999994040/-999992159*-999991603+(-999998938+-999993480+-999999084/-999997423*-999996217)*-999991377+-999998492/-999996897*-999999099*(-999999180-(-999994779+-999992267/(-999999828--999994887)+(-999991078--999994553*-999992669)+-999997475+-999994755)/-999996546+-999991184)-(-999998406--999998801)*-999997765/(-999997248/-999994533)*-999991202--999996366/-999999266*-999995257*(-999991611+-999999065)+-999990067--999998390+-999991539*(-999999204*-999990278)*(-999991775+(-999999452/-999997852)/-999998785--999991369--999994082*-999996827/-999996726)*(-999996676*-999994871*-999999151/-999994390+(-999999486+-999990041)/-999996332-(-999998752+-999998587*-999994854/(-999990802+-999991359)--999996727/-999991377*-999991518-(-999997358*-999990867+(-999997916+(-999997907+(-999992877*-999991401+-999999921)--999994047+-999994987*-999990825)*-999994031)+-999993430+-999991820*(-999998675/-999992440--999990550)*(-999994176*-999996033+-999995580)*-999995265)*-999999592*(-999992714--999999215/-999990057*-999991139/(-999993494-(-999993999*-999997143--999994625-(-999995361*(-999990757/-999997114*-999991638*(-999996708+-999990507)--999997234/-999993113)*-999998559/-999992038)+(-999995644+-999995344+(-999999790+-999995581)+-999996933)--999991788)+-999992301-(-999995909+-999996686*(-999994052*-999990161+-999996972*(-999997861/-999996299/-999996727--999997034*-999991284+-999994593)--999990471/(-999993178/-999991816)*-999992706*-999991624-(-999994072+-999993514+-999997740-(-999999867+-999990334)/-999998805--999995608--999993275+-999996303)*-999998785/-999998230)/-999997343-(-999997374--999996524)+(-999998755+-999994085)+-999993080*-999998112)+-999999253*(-999996225+(-999995537+-999998493)+-999994731)*-999997820)--999993204--999990449)--999991965)*-999996156-(-999993431/-999997967)/-999994637/-999997467*-999994544/-999995641)/(-999997978*-999994031)+(-999999569+-999994605)*-999999552--999992575-(-999999905/-999990115)/-999999837*-999996213/(-999993176--999992494*-999990977*-999997057)-(-999992445+-999991254/-999996540/(-999994914*-999992628+(-999992527/-999999883*-999990892*-999994731*-999995880)--999999994)/(-999992391--999992096/-999991413/-999990721*-999990664--999992298)+-999996289/-999992669)/-999996962+(-999990928/-999994228+-999991680)--999997325+-999994139--999991215/-999992240--999991565+(-999998131--999991393+-999993225/-999996288)/-999995527/(-999994440--999993977)*-999992376--999999159/(-999990595*-999999152)*(-999992786+(-999998998/(-999998963+(-999997992/(-999992739/(-999994549--999995018)+-999997144*(-999993104/-999993719/(-999994070--999996154/-999995509+(-999995370/-999998297*-999991461+-999998319)/-999990227/-999996382)*-999998466)+-999997933--999997160)/-999997432/-999999302/(-999996733+-999990850)/-999997650+-999995403)-(-999993555-(-999993563+(-999995137+-999994127/(-999991856+(-999991688+-999990623)/-999997953+-999994153/-999990708*-999993778/-999993235+(-999998676*-999999190)+-999995050*-999992963/-999997735)--999993393+(-999993122/-999993238)--999993451)-(-999990895*-999993593*-999995965+-999998902*(-999991653/-999997579/-999997786-(-999990602/-999990441*-999999743+(-999992056/-999998377*-999993767)+-999990776*-999992628)+(-999991695--999993061)--999990461*-999991272)+-999992089*-999995300)--999997765)*-999998910)+(-999998170*(-999998765+-999994762*-999996934)--999994650+-999996498/-999994928+-999998852)+-999991724)--999996917--999994191)*-999998216)+-999991649/-999993148*-999997444--999991069*(-999997878--999999977*-999991979)--999994524/-999995280*-999998286+-999990083--999992763/-999995664*(-999993117/-999994510/-999995261-(-999996189--999994278*(-999994821+-999991323)-(-999997679--999990222)--999996511+-999995082*-999998814-(-999992742--999995672-(-999991263*-999998355/-999990866+-999994500+-999992485+-999998809--999991018)+-999994559*-999996097)/(-999994390+-999991100/-999990219)-(-999994673+-999994482)*-999994529--999995482*-999992535)/-999995820+-999995001+-999993295)*-999996332--999993573--999992935--999992619+-999993801/(-999996931+-999996248*-999999725-(-999991820--999995403/-999998726*-999991012-(-999999188--999992176/-999997755)+-999996821+-999993522)-(-999993611*-999993833*-999991183)*-999990362*-999992479)*-999999702+-999996243--999994317--999991784*-999993699/-999994645--999996508*(-999997641--999997169)--999994755+-999994534--999992540/-999996779--999998200-(-999999089+(-999997576-(-999994218/-999997606+(-999996523--999997432+(-999992490*-999996298+-999999333*-999990725+-999992040+-999992684--999990150+-999996433*-999990177/-999996597+-999990833+-999991385--999994141+-999998183*-999991324*-999996443*-999999081)*(-999991051*-999994154/(-999998482+(-999992805*(-999994380/-999998590+-999999365)/(-999999694+-999993767*(-999990372/-999999768/(-999999662*-999990580/-999991029*-999995572/-999991786/-999998229--999999679)--999991551)/-999993976*-999992319*-999993444)--999995558--999997911)--999991559--999990173)+-999990966+-999997451+-999996477)--999996123*-999992899/-999998631*-999996592*(-999990361/-999991383)--999990657+-999999274*-999993605+-999991141)/-999998183--999996456)+-999996831+-999999139+-999998653+-999993794/-999991821)--999991771)*-999992025+(-999998351-(-999999535*-999994112)+-999998558--999997508-(-999995123*(-999997227+-999997133+-999995226)+(-999994636/-999999724--999993780--999991411*-999999734)+-999994067)--999996734/-999994786/-999996736--999995332--999999278*(-999992806*-999996781*-999995021/-999997932+-999990025--999993380)+-999991106/-999992574)*(-999992254/-999999133--999999251+-999998393)/-999999643-(-999994651--999994167+(-999993336+(-999994645/-999994114+-999991099/-999990409)--999995055+-999995791)/(-999994295/-999997532)--999995922--999996122/-999994547/(-999990223/-999995991/-999991357--999998447--999998329/-999996043*-999999643)/-999995547--999991921*(-999991281+-999992811)*-999995470/-999992235/-999997290)*(-999993729/-999993904+-999999807/-999993963)*-999992719+-999997077*(-999991514--999992547/-999998604*-999991248--999998478*-999998337/-999990998/(-999994928--999999098*(-999992893+(-999990699+-999994648-(-999994703*-999999933/-999997575)*-999991236)-(-999990930--999999031--999990979--999993267*-999996413--999992202/-999995710*-999996224/-999991621)+(-999992878*-999995854--999996128--999994183--999996851)+-999997584--999998718*-999996875)*-999995826/-999999561)/-999999730/-999997550*-999999258*-999990813+(-999998724+-999990541/(-999990928--999993222+-999997363+-999999777)*-999999487)*-999992259/(-999991690+-999998607)--999991739)*(-999995083--999996404*-999991711*-999995915/-999996142+-999998989*-999998866-(-999992729+-999991222--999993977+-999995819*(-999999832*-999991845*-999998595-(-999991753*-999994258+-999990024*-999998996/-999996008--999992303/(-999995154*-999995664-(-999996453*-999992046/-999991715/(-999997067*-999994887--999998734*(-999990803--999998386)+(-999991949/-999998711)+-999993850*-999990149--999990543/-999996335)+-999994128--999997824)+-999997216*-999997643)/-999990809)*-999993574+-999996646)--999992521/-999990880)*-999999054--999993166)+(-999998457+-999997567)*-999996600*-999996895*-999997004*(-999992093+(-999992083+(-999993580*-999997849/-999997080*(-999993055--999992218/-999998186/-999995644)/(-999998881+-999990932--999999295+-999991210*(-999997369--999997030)-(-999998474+(-999992422+-999998948)/-999994979)--999997867)+-999995575--999992981)/-999996610+-999995896+-999993421+-999997990/-999994297/-999992997)*-999995713)+-999993156--999990864-(-999994293+(-999990193/-999997293--999994962)--999995116*-999993223/(-999996323+-999996012*-999990704*-999996227)+-999998549)+(-999994159/-999995518)+-999995701*-999999843+-999990359+-999997199/-999992476+-999993019+-999993965--999995902*-999999586+-999996848*(-999999848+(-999998508--999990767)/-999991796/-999994305)-(-999991497+-999993247/-999998451/-999995845--999991611)--999997041+-999999164--999995878+(-999999212*-999996584+-999997297)--999991363*(-999999135--999995212--999991238*-999991462+-999995885+-999995699)+(-999996111-(-999992424+(-999996671/-999992821--999996909)-(-999992632-(-999995246+-999997451)*-999996940*(-999995324*-999998608--999998861/-999998366)+(-999992175*-999999716)+(-999992718*-999998982)--999996198/-999999818-(-999993924*-999990097)+(-999992131+-999999847+-999994127/-999995476--999996896/-999991181/-999991513/(-999999760*-999993703)--999992270+-999996264)/-999997191--999990723)+(-999994811--999990572/-999991687)+-999994298--999999614--999996200+-999994917)*-999994308*-999994405)+-999998611+(-999992972+(-999992394--999994825--999999631/(-999996330+(-999994160--999998519--999997432)+(-999990330+(-999994399+-999996249*-999998833+-999995110*-999995829)*-999996511)*-999992671--999999819/-999995212+-999998950)*-999995472)--999991743+-999992114/(-999990174+-999991879/-999999476+(-999995915/-999996424*-999992927-(-999995049+-999991826)*-999997163--999994834/-999990841)*-999995874)--999992517)/-999992628/-999992662/-999996290-(-999996939+-999991205)*-999995878+-999995540+-999993056+-999991551+(-999996982*-999997533*(-999998626/-999995274/-999990892)/-999998403/(-999999464+(-999996998--999991687*-999995685)/-999998775)/-999995986)/(-999997288--999995984--999995175)*-999995215--999998794-(-999994534+-999999998-(-999996294*-999997576--999998620--999999457)*-999997927/-999993418*-999990680-(-999990364*(-999992223+-999998418)/-999995713)/-999991905--999993896+(-999990426/-999999162)/(-999992948+-999997201)/-999997215/-999990663*-999996163)-(-999995529/-999994610--999991661--999999138+-999991206/(-999997496/-999998312/-999997631/-999991107--999998164--999991052)*-999996536*-999993603+-999993491+-999990419+-999999320*(-999990370--999990914)-(-999998520+-999992645)/-999992337-(-999991178*(-999992714+(-999997049+(-999998744/-999992030/-999991113-(-999992871/-999995102/-999995202)-(-999994916*-999997471*-999993791/-999997757*(-999990587*(-999998559+-999997009-(-999997487--999994677+-999992764+-999996729)+(-999996651+(-999992654/(-999993136/-999996930)/-999998784+-999999146--999993866+-999990055+-999993529+-999995802--999996130)--999992096+-999992631--999997316)*-999990412+(-999993195--999994116/-999992153+-999996521)*-999993309/-999991515/-999991589)*-999991017+-999996985+-999992762)--999992429+-999998407*-999994836*-999995138*-999993940*-999995562)-(-999994656--999991913--999999640--999995519*-999994041)/(-999993500*(-999995163+-999992205)--999992952--999998846)--999990476*-999999746/-999997408+-999991478/-999998846-(-999991380/-999994853)/-999994000+-999997598--999997059)*-999992666)--999996797+(-999990182--999998704*-999997719/(-999997427*-999995134)--999993706+-999994799+-999993447*-999994159+-999995792/-999993077)--999999531+-999993342)--999993447+-999999536/-999999833)/-999990856/-999994349)/(-999991437/(-999991784--999995354/-999993613)--999997241*-999999031)--999997491*-999997885+-999999361*-999991745+-999999281/-999997939/(-999995656*-999999746+-999994040*-999994030)+(-999996380-(-999998031+-999994778)--999992835-(-999990903--999990231-(-999995976--999991733)/(-999993667+(-999993227*-999994658)*-999997152)*-999999326+-999998101+(-999991507+-999998850+-999994854/-999992236)+-999991502)+-999997884/-999998583)+-999997583/-999996645/(-999995052/-999996887-(-999998417*-999994671)*-999995176/-999992949/-999991333+-999996315+-999993237--999995951)--999999841+(-999994569+-999997354)*-999990916*-999998585*(-999997939--999993935/-999991703--999990968+(-999990917--999992932)*(-999998115*(-999996773+-999997944/-999990118+(-999992483+-999997186--999993940+-999997618--999998883)+-999996720)+-999992412)/-999998284+-999994445+-999993007/-999993342)+-999993267*(-999995633*-999997856*-999995361*-999999172-(-999992884--999994822*-999995304)+(-999990152*-999998787+-999992917*(-999994618*-999999243*(-999993830+-999995147)*-999993621)+(-999995574+-999991124--999997876)*(-999990941+(-999999059-(-999994637*-999992778)-(-999992307/-999993466/-999992332)--999992680*-999993789*-999996868)+-999998904)--999995755/-999995681--999992660*-999996355*-999999907)+-999999425+-999992689-(-999993607-(-999992168--999990195+-999995372)/-999991205-(-999998630*-999993320--999996660*-999997278*-999998326/(-999993070--999998904)--999997553--999995959+-999997380--999997217*(-999997791*-999998948)--999992729)/-999995130-(-999992139+-999991933/-999997684+-999997908*(-999999653+-999996387*-999993880*-999991212/-999990631)/-999993072+-999991446)*-999996013*-999991036)+-999999577--999994401--999999404)--999992683-(-999991687/-999997564--999995628--999993842--999999852)*-999996687-(-999995423+-999999463)+(-999993607+(-999990593+-999997755*-999990451--999994891*-999994785)+-999991917)--999990825*-999992126--999999945--999995283+-999997195+-999993774--999995366--999999469--999990814/-999998305/-999993413+-999992635*-999997900-(-999994390--999990718)+-999992566+-999996917+-999994091/-999994637+-999991362-(-999996940--999996587*-999998534-(-999993407+-999992246*(-999992913+-999998614/-999995346*-999994513/-999996688--999991448)/-999992310*-999999840*-999990534+-999993175/-999995177+-999996989)-(-999998734+-999993920*-999999252*-999996925)/(-999997643/(-999991935+-999999377/-999994968+-999997905/-999993888)+-999992568*-999990174/-999994813)--999996951)*(-999992214*-999995667/-999995020--999993301/-999990260--999996250--999998714)+(-999995141--999990150)*-999992563/-999993105+(-999993087--999997135+(-999997954--999992719/-999990640--999997443)*-999996203--999997107)*(-999994619+-999995283*-999998920--999995209*-999994381*-999990789/-999990898)*-999995150/-999991547*-999997933/-999991753*(-999992135/-999995887*-999991649*-999992101)+-999994025+-999999777/-999998274+-999992850/(-999998494+-999994717/(-999991008-(-999995360*-999996190)+-999995177)*-999998070--999996149)+-999994365+-999999141--999995443+-999994471*-999992694+-999995407+-999997319+-999996871*-999997252/-999993008*-999990620*(-999997383*-999999091)+-999999530+(-999991814--999991803)+-999990909+-999999486--999994755--999992886+-999996659+-999995848--999993298*-999992069-(-999992105+-999991409/-999997059+-999993687+-999998592-(-999995499/-999997328/-999994878*(-999991178+-999995010+-999994503+-999993315+-999995744)--999992372)/-999997303+-999997454)+-999994800+-999992163*(-999995459--999993312--999997807+-999999309*-999990358)-(-999994114/-999993113)+-999996112*-999995758/(-999990752/(-999997311*-999997306-(-999995452+-999995191)+-999990602)/(-999992930*-999993739)+-999995644--999993385+-999992055*-999996095)*-999990698/-999992595/-999994615+-999998345/-999995405/(-999995131--999990573*(-999995353--999998776*-999998639--999998357)--999994751)--999992762*-999996759/-999990342+-999992108--999992621/-999993035/-999992879--999995946+-999998636*(-999995887/-999995549)--999997777*-999993743+-999992034/(-999991702/-999992039)*-999994840/-999998647--999995345/-999993407/-999997708/(-999990527+-999998678--999991992)*-999997933+-999992295+(-999996322--999992730--999992666)/(-999998069*-999991155)*-999991012/-999990887*-999998304/(-999996574/-999991335--999990178--999992535/-999999279+(-999990592+-999990664+-999995451)+(-999992446*-999998219)+-999999610-(-999998301--999993028)--999993895+-999993960)/-999999554/-999997379+(-999991590+-999999382)/-999996596/(-999996019/(-999995609*(-999997546-(-999997939--999996902*-999995229+-999996281/(-999994777*-999995660/-999996613+-999995184)+-999999339+(-999997590+-999994694)*-999990729/-999993675)+-999990185/-999997732)+-999999061+-999999401)/-999996243)+-999995521--999994073/-999999027*-999993938-(-999991231/-999997018/-999996829/-999999047)+-999999148+(-999996406--999994140--999995521*-999991953*(-999996568*-999996102/-999993729)/-999995639+-999998808)-(-999992884/(-999990783*-999994761--999991504--999996786/-999996815+-999999532*-999994958*(-999993195--999994004+-999999097*-999997625)--999992722--999999520)*(-999995477/-999990273/-999990268*-999993509--999997850--999998508--999991326+-999993003*-999994559)/(-999990551/-999995923--999993474)/-999995456)--999996474--999996135/(-999993289+-999993627)*-999992906+-999991447/(-999996879--999994431)*-999991248/-999994739-(-999990472--999991293*(-999999359--999992984*-999999804)/(-999998956/-999998591/(-999991568*-999990218)--999998107/-999995362)--999996058)-(-999990710+-999998311*(-999998818+-999990261*-999993258+(-999999322+-999990921*-999995486--999997763)/(-999999433+-999995577)--999993925)+-999997782--999990416*-999996632/-999995286--999994319)+-999997688*(-999994933--999999890+-999990634--999999918--999996960--999993677)*-999995364--999991735--999990389*(-999995143--999991127)*(-999995724+-999998497--999999390*-999990772/-999997359/-999993899/-999999900)-(-999992002*-999990132)--999990290*-999993299--999997365--999998867+-999991153*-999991738+-999998884--999990248--999990120--999998795--999992719/(-999992169--999992907)--999994049-(-999994614+(-999991381+-999998658+-999995473)/-999996529)*(-999990125-(-999994347--999993015)--999996922*(-999992778/-999990550+-999997423--999995342/-999996328)--999994850*(-999995027*-999999805)/-999993890)*-999991780--999999091--999999314--999997105/(-999998238--999996745+-999992546)--999998540+(-999994676/-999991253+-999998709)--999994240+-999998823*(-999998502*-999996410*-999994479)-(-999996350*-999991117)/-999995399/(-999999238--999998548)--999991522*-999997789-(-999999026+(-999995016--999990495)*-999995560/(-999993173/-999997217/-999998044/-999997241*-999993152)*-999997444*-999998140/-999998293-(-999990681--999995333)+-999991936+-999997573)+-999997369+-999990638-(-999994233*(-999994308-(-999990057/-999992804/-999996423*(-999994666+-999995962/-999997086*(-999996491--999997597/(-999990056--999994178/-999990003)--999999455)*-999996857/-999998668/(-999992767+-999995105+-999992721*-999990356/(-999995608/(-999993881--999998023)--999995210--999995578+-999993445+-999991045--999992334)*(-999996065/-999996206*-999991156-(-999991068/-999994732+-999999976)--999991609/-999992135/(-999996370/-999995624)*(-999991805/-999997038)/(-999997089--999993374+(-999991722-(-999996583/-999996895--999998291*-999997770+-999996322+-999991302)*-999992326-(-999991159/-999992093)*(-999997134--999997385--999993480*-999996665*-999991036)--999999072)--999996331+-999996927/-999997092)+-999997586)+-999993495)*-999993526--999997465)*-999998156)+-999994886)/-999991220/-999991799--999993483*(-999994307/-999991284*(-999992602*-999996277*-999998374/-999997607)/(-999992793--999995514/-999997223)+(-999998507/-999993577*(-999999385--999990375--999999908-(-999995594--999992591)/(-999998282/-999993753)*(-999996836--999996662*(-999998695+-999996575)*-999991940)+-999998103*-999997713+(-999999506*-999990116)/-999990382)--999992479)*(-999999806/(-999991768/-999990374+(-999996479*(-999999770/-999997095--999990645)+-999993765)*-999993130)--999996598+-999995943*-999992940)--999994795--999994527)--999991823*-999998166/-999998138+-999990088--999990837/-999996983*-999995371)+-999998470/-999997166/-999995327/-999990162/(-999990539+(-999995529/-999993531+(-999997876+-999997800*-999996749/-999997802)+(-999995833*(-999998421/-999992836+-999992684--999991586--999997925)+-999998734--999999489)*-999993906*-999998359+-999996830--999995582*-999998950*(-999992118*-999997071*-999990394--999996223*(-999996724+(-999991376/(-999998938--999992746*-999991478*-999995863)--999991862-(-999997774/(-999995795+-999993109+(-999994745*-999994231+-999996742*-999990593)*-999996910--999990429*-999999047*-999999977)/-999991394*-999990414/-999993357+(-999995220/(-999996519--999995523)+-999993794/-999995335/-999992601/-999998430/-999994014)/-999991273)/(-999998465*-999994416*-999990283*(-999997564*-999999123*(-999998429--999993978*-999997525-(-999994107*-999992159)*-999998234*-999998146*(-999997584--999996169/-999995052*(-999991781--999991013+(-999996252/-999990537)--999991092/-999999858--999992670--999990191--999997174/-999996476)+-999992648*-999998585+-999999169+-999995150--999997468)--999997657)/(-999998781/-999991350--999990257--999997642+-999999940/-999994850*-999993911)+-999990766)/-999997581/(-999994259--999996648)--999997279/(-999990974*-999995515)*-999994084+-999992532)*-999998061*-999999322)*(-999996853/(-999992215--999993157*-999998588*-999999685)-(-999998797*-999993140)-(-999995512+-999996772*-999995445+-999990404+(-999990955+-999993587-(-999997752+-999990048)*-999993465--999999128)+-999999150)/(-999994326/-999991075--999992835)/-999993060*-999993465+-999997718)/-999996825)*-999996927)-(-999999505+-999996075)--999990589)*(-999999746*-999992790+-999999133)--999998710/-999994035--999994020)/-999990409+(-999991325/-999991891*-999993740)-(-999997466+-999996867+-999992903--999999375+-999998850/-999990933)/-999996391/-999998711*-999992083+(-999997650+(-999995562-(-999992163/-999999699+(-999993529--999994111/(-999995410*-999993130/-999996688)/(-999995156/-999996937--999990688)/-999995522-(-999999591/-999995241)/(-999991056+-999998171/(-999990977-(-999995531+-999993271+(-999998229+-999992337/-999991293+(-999997384/-999997107*-999999408+-999999180+-999997242+-999994202--999997330)/(-999996328--999991194*-999994656+-999995353/-999998169)/-999991282)--999994757--999994354-(-999997281+-999994968*-999993565+-999998086+-999991678)+-999998540*-999991565+-999995119--999997200)+-999992418/(-999996422+-999990162*-999997809/(-999992825--999995982+(-999999772/-999991888)*(-999994846/(-999993799/-999990571*-999995258*-999997713*-999992381)+-999993035*-999993174--999999786/(-999997113*-999995319+-999991986)--999991760)-(-999998778--999997387--999991403)*-999991417--999999821*-999996183/-999992074/-999991562*-999995244+(-999996324/-999992213--999999065)*-999991954/-999999028)*-999991329--999993170/(-999990251*-999991644)+-999993946+-999999485)--999993716)+(-999996073--999995039*-999992825/-999998639)*-999994819)/(-999997960/-999991052+-999991742--999994852*-999995753)*-999998036+-999991103/-999992315+-999998865--999999102)/(-999995543--999999066*-999993564)/-999993952/-999991959--999998683+(-999991966--999992251--999992365)/-999995397)/(-999995850*-999993300)--999996456)/-999997014*-999992619+-999997923*-999993394)+-999997726*-999996750--999996741--999994312*-999990977+-999999827--999991938-(-999990334/-999991641)-(-999991539+-999995865*(-999993720/-999992140)+-999991547--999994299/(-999999410+-999999846+-999992897*-999994261/-999992640)--999994263--999995310)/-999998285*-999991278-(-999998314/-999996564)/(-999992835--999993828*-999991097)/-999999183--999994297/-999991876+-999994337*-999997774--999993745-(-999990331--999996385)*-999994741+-999996137/-999996334--999998736*(-999999773*-999997735)*(-999997697/-999996190--999993047--999995610*-999991462)*(-999990180+(-999991089/-999990299+-999996561)/-999996730*-999998805+-999995797)/-999991613*-999992429--999998840*-999991157/-999999789*-999993167+-999994260*-999992360*-999997496/(-999993728-(-999993850/-999999539+-999991255+-999993732*-999994647)*-999996094*-999992666--999990033)+-999990583--999990728--999995830+-999992230*-999999219--999992913+-999993415/(-999998195/-999992755--999993477/-999995224)*-999994036*(-999994039+-999995130)/(-999998724*-999994779+(-999993481*-999995396*-999999098)*-999994474)/-999997542+-999994523--999991548*-999992161*-999990760--999992522/-999994889*(-999999153*-999993331)+-999991578--999999154-(-999994131+-999993248)*-999993109/-999993347*(-999991491--999999570+-999994384+(-999990630/-999999725/-999996138--999993324-(-999998531-(-999996673+-999996396)*-999998144--999990581--999994161+-999997745)+-999996033)/-999992934+-999994084*-999995278+-999992424)+-999995437/(-999996014/-999990943+-999998257*-999992305/(-999995958-(-999997390+-999996801/-999999180+-999994563)--999996123*(-999993574+(-999992848+-999997940--999993249)+-999996698--999991072*-999996237+-999991173)--999997274--999995826)+-999993402+-999992340)/(-999990097+-999994314/-999993994*-999999487--999994656--999993549*-999996108/-999990052*-999996878/-999992770/-999995109*-999994283--999996390)+-999994439+-999997821/-999993677+(-999997731/-999990919+-999992966/(-999993531--999991194/(-999999812/-999999827--999993741--999995483+(-999993908/-999999323--999998275)/-999996611+-999991192)/-999993603--999998458/-999998204)/-999998100/-999998192)*-999995964/-999999892+(-999994065*-999997167)*-999999090/-999996078/(-999991022/-999991467)/-999996912*-999990779/-999996828/-999992143*-999991273*(-999999737--999990802)/-999997725*-999991097+(-999991608+(-999997846--999993236/-999993927--999993471+-999999969)+(-999996526--999994438*-999992551--999994895--999992717--999994834--999995454--999997908)/-999996749--999999855/(-999994185/-999997693/(-999995129/-999990378)--999993343)*-999997227--999995200/-999991902*-999990005*(-999994823--999993729+-999992638/-999998235)*-999993332*-999998386+-999991477+-999991857*(-999994063--999997032--999993444)--999998159)*-999991469+-999992125/-999990018/(-999991851+-999991386-(-999999528--999996645)/-999997173/-999992865*-999990581)-(-999993371/(-999991634/-999990779*-999999778)/-999990751/-999998010)+-999995514*-999998824+(-999990330--999998495*-999996165*-999995069)*(-999991093+-999992581)*-999991752-(-999991626*-999995848)/-999998312+(-999991045/-999995262)*-999993688/-999993337*-999991799*(-999997945-(-999990728/-999995404*-999995591)*-999995786)+(-999991739/-999990176)-(-999998056+(-999990586--999996246-(-999996150*(-999994282-(-999996094/-999996022/-999990077+-999996852*-999997310/-999991630-(-999990282*-999993220*(-999996032*-999996426)--999992621+(-999990452*-999990751*-999994028/(-999997763*(-999995152/-999990269)/-999991258--999993809)--999996305/-999995498)/(-999999574+-999993870/(-999996775--999992070)/-999992785--999992493+-999995816+(-999994830+(-999995044--999991298/-999999910+-999993108)*-999997465)/-999996261)--999995560/(-999991098--999999810/-999994421)+(-999991894*-999995494+-999994640/-999996114--999991472--999999651/-999998525+-999990370)*-999993114--999997977)+-999995318)--999996821*-999994057)+(-999993941*(-999995269--999997738--999994111)/-999997660--999992934)--999999372)*-999994441--999994725*-999994263)--999999818)--999997059--999999784+(-999998990*-999999080)*(-999994509--999992849/(-999990614+(-999999459/-999997909)+-999990533)--999994677)/-999995998/-999994909--999995596*-999990786+-999995730/-999999842+-999995715--999998361/-999991551--999992532+-999992921+(-999994204+-999996237)*(-999998787+-999998568)--999998315*-999996990+-999992221--999993042+-999995297/(-999995639/(-999995716+-999999171)*-999998563)/(-999994407+-999996561/-999990097/-999995517)+-999991359--999995182+-999997763-(-999991859*-999997668+-999994477+-999991432)*(-999994323+-999990247--999995318)-(-999990412/-999997489+-999999059+-999990380)/-999994418*-999993297--999992731*(-999995183+-999996952+-999991540)*(-999993818--999998165*-999993488)/(-999994032+-999999563/(-999995380+-999993122--999997917+-999990456)+-999994914)-(-999997195--999993984)--999992827--999991187*-999998304/-999996775/(-999994924/(-999990098+-999994695--999998259--999992446-(-999991542/-999997122/-999994360*-999992562)*-999993408)--999998649/-999999022+-999998371/-999992207--999997276*-999994523--999999773)*-999995670*-999998107/-999998876/-999999362/(-999992851/-999995057/-999991650)--999995245/-999991879--999999434*(-999997009+(-999992796--999996457-(-999994891/-999998707+-999990912)*(-999990179+(-999993095--999993763/-999997371*-999998168/-999996575)/-999994185)*(-999995310/-999997065-(-999996856*-999999524)*-999995172+-999997918)+-999994298)*(-999999134+-999997856--999997474+-999995332--999991275)+(-999990975*-999993844)/-999993434)-(-999992212+-999993066--999992715/-999996412)/-999991225*-999993831--999994765--999999925/-999996436/(-999996045*-999997046)-(-999998357--999991540/-999994660)/-999996389*-999994773--999997060+-999999771+(-999998871*-999996591)-(-999994699+-999998862/-999990918+-999998888*-999990109*(-999996261--999993519)*-999993698*-999997072*-999999789+-999992492)*(-999994904*-999995970--999991177)--999990631/(-999994472+-999993368/-999991663+-999992048*-999999617/-999992958/-999993450)+-999991503/-999991841/-999992934/(-999993294/(-999991730*-999998535)*-999998898-(-999997841--999994316--999998758/-999992930--999992745)/(-999991519+-999998793)*-999995208*-999995509--999996794+-999993014-(-999990780--999994655)*-999996722)+-999990460+(-999991038/-999994229)--999990965/-999992897*-999993595*-999992721/(-999994466--999997786/-999993647)--999999366--999992527--999998715-(-999990576*-999999107/-999992097--999991067--999997360)*-999990874+(-999999828*-999991876*(-999997001*-999995435*-999991195/-999992747)*-999997834)/-999999600*-999992812+(-999992037*-999995546/-999990219--999991827)+(-999999229--999993047)*(-999999953-(-999997879*(-999991320*-999998066*-999994259+-999996023--999997288*-999999634*-999999862--999992676)/-999995306)*(-999992161+-999994142*-999994069/-999992809*-999996859+-999991351-(-999994215+-999991981/-999992178)+-999990937)+-999993467--999997472/-999995274+-999991215+-999999181-(-999991382*-999998386*(-999995672*-999992546--999997992)*-999991206*-999998918+-999997674*-999996665)*-999994856--999998250)*-999993025-(-999996081--999994274+(-999999627*-999995219-(-999999340+(-999998027/-999991495--999992513--999995415+-999991887+-999998342--999997563*(-999996317+-999991852)*(-999996146*-999994133*-999994534--999995052/-999997962*-999990455+-999999787/-999994708-(-999997692/-999996294*-999998255)*-999991373*-999993088--999999359+-999993651*-999991170*-999996265)+-999991125*-999992365--999991424)/-999997455)+-999997197+-999990245)/-999992486+-999997281-(-999994074+-999990054)--999998929+-999993479+-999997717)+-999995039+-999997176--999992962-(-999996569--999991762)--999993994*(-999991877+-999995321*-999996591)--999998225/(-999997799/-999992932)/-999995422--999996323*-999990570*(-999996865*-999993768*-999997119--999999388)*-999994434--999993283+-999990475/-999993424+-999996310*-999991313/-999995188+-999996886*-999998985+-999996812/-999997595/-999997590-(-999994178/-999996363/(-999999652--999999170/-999997283)/-999992440/-999992405)+-999996183*(-999998758*-999991646)*-999996315*-999994239+-999999290+(-999997657*-999997420+(-999996855-(-999998644--999997806)+-999994081/(-999994481--999993389)--999999136+-999993074)-(-999995130--999992851/-999999744+(-999998702+-999993697*(-999992129+-999998686--999998424/-999998942+-999992975/(-999999449+-999999754+(-999992706/-999996454)--999997349+(-999993546+-999999248*-999995285)+-999992642+-999999324)--999991875*(-999990035+(-999994488--999990328*-999993201--999998740)+-999997430/-999995387+-999990487)+-999994166/-999994123)+(-999991052/-999992150/(-999992739/-999991364-(-999999448*(-999999786+-999991765)--999999776)*(-999995050*(-999997469*-999993596/-999999496+-999999165)+-999997144*(-999994030--999991225--999994896)/-999991612)/-999997442--999994467/(-999995497+-999993612*-999997178-(-999995695-(-999997349/-999990632)+-999999152)*-999994990+-999998199*-999998340--999997713*-999990798/(-999994874*-999990634)/(-999990154--999993083*-999995902)*-999998518)*-999992325+(-999996743+-999998051*-999991438-(-999997727--999997502)--999994364)+(-999996297--999990491/-999996669+-999994411+-999992831)--999994277+(-999998490+-999994959/-999999660)--999998052)*-999999414*-999993643/-999995666*-999999965+-999996714)/-999997442)-(-999994883--999995653*-999996081)*-999995823)+(-999997312/-999996297/-999993412)--999993001/-999991936/-999990450)--999997383/-999996992-(-999995650--999996343)--999990535/-999994161*-999997974+-999993683+-999994473*-999995354+(-999993862*-999996049--999992648/-999999400*-999997398)*(-999998521+(-999993164+-999991240--999996048--999996453)--999992928-(-999990323--999990798*-999993816)*(-999992742--999996956/-999992131/-999997310)*-999992481+-999990682)+(-999998422*-999993801)+-999992105--999997862*-999996630+(-999995272/-999993322--999990957)/-999996379/-999991367*(-999994660*-999999616--999995813*(-999999846*-999998587)+-999996453)--999990020*-999992797+-999997868/-999998487/-999991227+-999992404*-999995542--999996518*-999994450--999995482+-999996428+-999995826+-999995119+-999991361*-999997332/(-999999926--999991229*-999999673)--999999956+-999993926-(-999991583+-999996833-(-999998498/-999998574--999990886)/(-999999829--999992605)*-999996635/-999991609)*(-999994494+-999995062/-999996002)*-999995700+-999996299+-999997452+-999998742/-999999579*(-999992540+-999998023)*-999997878*-999998762--999990507/-999994852/-999996268--999996165-(-999999382*-999996372*-999998215+-999999161)--999990845/-999994214*-999995073/-999995013/-999993752+(-999993436*(-999991566+-999992944)+-999999521)*-999998365/-999995381/-999997603*-999991359+(-999994121*(-999990098/-999993432-(-999997310*-999998838)+-999997852--999990669*(-999997130+-999998206/-999996563/-999994597--999992719*-999990296+-999990183/-999990591+-999993379)/-999997731+-999990319--999995809*(-999998360*-999996272+-999998707*-999998779)--999996897/-999993382/(-999999444*-999998946--999999154--999998741+-999993144)--999998136+-999996304/-999999941*-999991060)*-999996239--999997700)/(-999991349--999996555-(-999998460*-999994575)--999990084/-999999961)+-999995715--999993500/-999996756/-999994173+-999990569*-999996787*-999990430--999993372+-999998795-(-999994931/-999998404)+-999993663+-999997435--999992939/-999995521*-999995240/(-999994377+-999993565*-999995063)*(-999991511/-999990666)+-999995650+-999998687+-999996390/(-999999640*-999996078)*-999999677/-999998534/(-999992340/(-999994424+-999993894--999992171--999994940--999996342)*-999990619+(-999995928*-999996755+(-999994789/-999990611+-999997345-(-999996395/-999999200/-999999552--999991669*-999995911+-999995209/-999991049)/(-999990792--999998008+-999995666)+-999993227*-999999760)+-999993255*-999993453/(-999992965/(-999991080--999997740/(-999997113--999990284)/-999991008+-999992118)*-999991888*-999997735*-999991507*-999993936)--999998205--999997578/-999994903)/-999990556)+-999992099/-999995350*(-999995552+-999996769--999997677-(-999995947*-999998692)--999995854+(-999995575--999997590/-999996019)*(-999992686*-999993033/-999992806*-999990674*-999993835)/-999999144)*-999997039/-999994291--999994617+-999990464-(-999990309+(-999999882*-999999158)/(-999997040/-999991172)+-999998539-(-999997589+-999999997)--999995194*-999994846--999990518*(-999992077*-999994918/-999990229+-999995811+-999993622*-999998886)+-999999587)/-999991985--999996246--999996218+-999992147-(-999990675*-999997275+-999995832)+-999999349+(-999991772--999996142*-999997676+-999999233+-999998701+-999997747/-999991456+-999995510*-999998330*-999991607)+-999992145--999999567-(-999993139/-999992390+(-999996840*-999993953+-999992713)*-999997258+-999991574+-999997368)+-999992687*-999998360+(-999995589+-999993125)*-999999711--999998684*-999996693+(-999996847/-999991405*-999990270)+-999994347+-999999549/-999995189/-999991751/-999992439/-999992313-(-999996672*-999997095)--999995698+-999990044+(-999997151-(-999993846/-999990884*-999991467/-999994745+(-999991787/(-999990221*-999990938--999999903+-999995591*-999990555+-999991549)/(-999990966*-999998327*-999990493)+(-999996721+(-999998846--999991988)--999991012-(-999994332*-999995538/-999991681)*-999993882)--999992922+-999990461+-999990189)+-999994442+-999994067)--999990187+-999992492*-999997761-(-999993350+-999990904)*-999994886+-999995487*-999995126+-999994585/-999992501/-999996303--999993145)*(-999995274/-999997101--999994244)+(-999992962*-999996461--999993864/-999995201+-999990786)/-999994029--999999314--999991109--999992112*-999995365*-999993128-(-999998453*(-999996435/-999996757/-999997971--999999519*-999993810)/-999990811)/-999998987/-999997465/-999991632*-999992925--999992395+-999997810+-999991418*-999995519--999998188--999994516/-999990767/-999999070--999990165+-999995573-(-999999141--999998621)/-999997663-(-999990925--999996427*(-999998890+-999992322)+-999999413+-999994795--999998708+-999990762)+-999992288+-999992276+-999991044-(-999993117/-999997455/(-999991421*-999997431+-999997569)+-999991376)/-999996757*-999993484/(-999992543--999994090-(-999999215/-999991117--999992864*(-999994826/-999991954)/-999999225*-999999662)-(-999994254+-999996340/(-999998597/(-999995583*-999993799)--999996197)+-999998192/(-999997877*-999994288)/-999990564)--999998764+-999992771/-999990823/-999997053*-999995027)-(-999997715--999992951)*-999996424*-999996226+(-999999807/-999998376)--999997501+(-999995550/(-999997084/(-999997816/-999996868)+-999994447--999999001)/-999990199)+-999994213*-999991064-(-999999392*-999994069)/-999995649--999999101/(-999991782--999992368+(-999999835+-999998413/-999992069/-999999311)/(-999990148+-999999729-(-999997715*-999995654/(-999995323*-999999037*(-999997034/(-999997557*-999996994--999994251)+(-999990711+-999990012*(-999999413/-999998704)+-999998807)/-999994244+-999992594)*-999996377*-999996427--999990676+-999997347/-999991465)+(-999993375--999999706*-999990788+(-999994937--999991145-(-999997459*-999997050*-999996363)*-999996759--999993070*-999990690)*-999999103*-999995830/(-999991115*-999999030+-999991140--999995586)/-999998344--999992550-(-999990626*(-999997066*-999991281)/(-999994544*-999993151)--999991029-(-999996540--999992146--999995508+(-999995275/-999997463--999990834)--999993530*-999998280)+-999999154*-999996899+-999995141)+-999995791/-999991286+(-999990254/-999999384/-999996803+(-999993726*-999993852*-999995235)--999994757)/-999996768*-999995378-(-999991728/-999999354)+-999993768)--999992853)--999997358+-999995682*-999990959+-999997090--999996500-(-999994262+(-999997730--999993368)*(-999998206/-999993552--999990761)/-999994376)+-999998735/-999995329/-999991536)+-999998365)+-999997618+-999990071/-999992524+-999995766*-999990451/(-999993298--999992014--999997785)+-999998990/-999996624+-999993527*-999995601-(-999996924-(-999998580--999993257--999990273-(-999992838/-999992221--999999847)*(-999999319-(-999999414--999998073*(-999991217/-999991259--999991486/-999990857+-999995737+-999993271--999996479+-999992427)+-999998685*-999993979+-999994617)+-999993180)+-999991563+(-999996512*-999999631)*-999990559*-999993325)/-999995637)-(-999990329+(-999992865-(-999999049--999995499/-999990623*-999990646*(-999993302+-999999404)--999994210--999993351/-999990040)--999995628)/-999998194)+(-999990432+-999990075+-999997101)*-999994610--999997382*-999991524*-999996894/-999992894*-999999009--999997585--999995885*(-999994215*-999992126--999995392)*-999990669/-999997334*(-999990194/-999992944/-999994402+-999995026--999992337)--999994959+(-999993004+-999993981)--999990281--999998540*-999993038*-999993256*(-999992240*-999993475)-(-999998672--999993692+(-999990826--999993581)/-999990972/(-999991143-(-999992625--999994825)*-999990940*-999998566*(-999995845+-999997051*-999996314)+-999990096/-999993770*-999993777)/-999994208--999990105--999998120/-999995746*-999998242)+-999995243--999996067+(-999998018--999992209)+-999999483/-999994943+-999999554*-999990876+(-999990548*-999990342)+-999998952*-999991572*-999990997/-999997469+-999996202+-999995097/-999994681*-999990139/-999993861*-999992870*-999990630/-999994343--999996147+(-999991807+(-999996993--999991857*-999995135/-999992589/-999992817--999995131)*-999991370+-999990979+-999999303*(-999992217+-999995668--999994513)/-999991192/(-999999127-(-999991563*(-999991463--999991601)+(-999999115*-999992855)/(-999990159+(-999990979--999995088--999990247)*-999997204)+-999996219--999998828)+-999998059--999990177)/-999993886--999999157*-999998587/(-999997186*-999993916*-999992743--999993963-(-999990020*-999999423)--999996042+-999994015)+-999995606)+-999995735+-999991387+-999994753+-999995920+-999994063--999990318/-999992128*-999992414/-999999676+-999994951+-999995925*-999997656--999990221+-999998160*(-999998750*-999991913--999998191+-999998201*-999992416+-999990227*-999996148/-999999140+-999992405)/(-999990462+(-999992088--999999879+-999994784+-999992349--999992342*-999992147--999999591--999991413)/-999995771)--999995938+-999998230*-999994761/-999993868/-999996777+-999997579*-999995221--999999203*(-999998630+-999999657)*(-999993682-(-999995274/-999992950)+(-999999887+(-999997919+-999999602)+-999991744)-(-999997636+-999990219)/-999994685+(-999994950+-999997350+(-999993622*(-999991581*-999993247)*-999998141--999994300+-999998198--999995642)+-999991648*-999992059)*-999992133)*(-999997381--999995233/(-999996780+-999996702--999997545*-999994299/-999992191)+-999990410)*-999998658/-999992805*-999993896+-999996236+-999999542/(-999996944--999993210+-999998314*-999998852--999997252+(-999996761/(-999993165+-999993964/(-999994557--999999156)/-999993551)/-999992794)*-999996588)*-999990529/(-999998884-(-999999464/-999995375+-999996627*(-999994270+-999999726+(-999999308*-999999994-(-999990914/-999999473+(-999996440/-999994101/(-999992263*-999998971)*-999998091-(-999996917/-999997817+-999998988+-999999957*(-999994811/-999990211/-999996435*-999990632+(-999991405+-999990819)/-999998570/-999996758*-999998006*-999996885)/(-999994935+-999993957+-999993958)*-999992593*-999996768--999996816/(-999993382*-999991244/-999999208*-999997177/-999993343/(-999998071/-999996045)+-999993390--999992730+-999991398*-999998331--999990393)--999999366)+-999993017)*(-999994782/-999992101--999994479)/-999995645)/-999998836)--999999616+-999997208+-999992881*-999994259)*-999993291*-999996466*-999999682/-999995548)*-999996566*-999997879+-999991024/(-999990266*-999999328/-999995620)/(-999991158/(-999999787--999998201-(-999990135/-999998586/-999993364*(-999992469+-999994218)+-999994168+-999999952)*-999994150)/-999996708)*-999994683*-999992808--999995690/-999995528*-999995707/-999992336+-999995935--999992459)--999992823/-999998123-(-999997879*-999999615)/-999994841/(-999993085/-999991869/-999996122+-999993166)/-999991235/(-999990303/-999990288--999991982--999996017-(-999994698--999992246/-999995212/-999991418/-999997924)-(-999998398/-999991743*-999991788)--999994644--999996616)"



    --result 11254763



isDigit :: Char -> Bool
isDigit '0' = True
isDigit '1' = True
isDigit '2' = True
isDigit '3' = True
isDigit '4' = True
isDigit '5' = True
isDigit '6' = True
isDigit '7' = True
isDigit '8' = True
isDigit '9' = True
isDigit _ = False

isOperator :: Char -> Bool
isOperator '+' = True
isOperator '-' = True
isOperator '*' = True
isOperator '/' = True
isOperator _ = False


tokenize :: String -> [Token] -> [Token]
tokenize [] ts = ts
tokenize (' ':xs) ts = tokenize xs ts

tokenize ('(':xs) ts = tokenize xs (OpenBracket : ts)
tokenize (')':xs) ts = tokenize xs (CloseBracket : ts)

tokenize (x:xs) ts 
    | isDigit x = 
        case span isDigit xs of
            ([], ys) -> tokenize ys (Num (read [x]):ts)
            (ns, ys) -> tokenize ys (Num (read (x:ns)):ts)
    | isOperator x = 
        tokenize xs (Operator x : ts)

tokenize xs _ = error $ "Unexpected error" ++ xs

calc :: Char -> Int -> Int -> Int
calc '+' x y = x + y
calc '-' x y = x - y
calc '*' x y = x * y
calc '/' x y = x `div` y
calc _ _ _ = error "Unexpected operator!"

p = 10 ^ 9 + 7

calcPow :: Integer -> Integer -> Integer
calcPow n 1 = n
calcPow n 2 = n * n `mod` p
calcPow n e =
    let halfe = e `div` 2
        half = calcPow n halfe `mod` p
    in 
        mod (if mod e 2 == 0 then half * half else n * half * half) p

calcMod :: Integer -> Integer
calcMod n =
    mod (calcPow n (p-2)) p

modDiv :: Integer -> Integer -> Integer
modDiv x y =
    let (x', y') = if x < 0 && y < 0 then (-x, -y) else (x,y)
        modx' = if x' >= 0 then calcMod x' else - (calcMod (-x'))
    in if abs y' `mod` abs x' == 0
        then y' `div` x'
        else (y' * modx') `mod` p 

evalMulDiv :: [Token] -> [Token] -> [Token] 

evalMulDiv [] as = as
evalMulDiv (Num x:Operator '*':Operator '-':Num y:ts) as = evalMulDiv (Num (-y*x `mod` p):ts) as
evalMulDiv (Num x:Operator '*':Operator '+':Num y:ts) as = evalMulDiv (Num (y*x `mod` p):ts) as
evalMulDiv (Num x:Operator '*':Num y:ts) as = evalMulDiv (Num (y*x `mod` p):ts) as

evalMulDiv (Num x:Operator '/':Operator '-':Num y:ts) as = evalMulDiv (Num x:Operator '/':Num (-y):ts) as 
evalMulDiv (Num x:Operator '/':Operator '+':Num y:ts) as = evalMulDiv (Num x:Operator '/':Num y:ts) as 

evalMulDiv (Num x:Operator '/':Num y:ts) as = 
    let (x', y') = if x < 0 && y < 0 then (-x, -y) else (x,y)
        modx' = if x' >= 0 then calcMod x' else - (calcMod (-x'))
    in if abs y' `mod` abs x' == 0
        then evalMulDiv (Num (y' `div` x'):ts) as
        else evalMulDiv (Num ((y' * modx') `mod` p):ts) as
evalMulDiv (t:ts) as = evalMulDiv ts (t:as)

evalPlusMinus :: [Token] -> Integer

evalPlusMinus [Num x] = x `mod` p
evalPlusMinus (Num x:Operator '+':Num y:ts) = evalPlusMinus (Num ((y+x) `mod` p):ts) 
evalPlusMinus (Num x:Operator '-':Num y:ts) = evalPlusMinus (Num ((y-x) `mod` p):ts) 
evalPlusMinus ts = error $ "Error in evalPlusMinus!" ++ show ts



evalDoubleUnary' :: [Token] -> [Token] -> [Token]
evalDoubleUnary' [] as = reverse as

evalDoubleUnary' (Operator '-':Operator '-':Num y:ts) as = evalDoubleUnary' ts (Num y:Operator '+':as)
evalDoubleUnary' (Operator '+':Operator '-':Num y:ts) as = evalDoubleUnary' ts (Num y:Operator '-':as)
evalDoubleUnary' (Operator '-':Operator '+':Num y:ts) as = evalDoubleUnary' ts (Num y:Operator '-':as)
evalDoubleUnary' (Operator '+':Operator '+':Num y:ts) as = evalDoubleUnary' ts (Num y:Operator '+':as)

evalDoubleUnary' (t:ts) as = evalDoubleUnary' ts (t:as)


evalDoubleUnary :: [Token] -> [Token]
evalDoubleUnary ts = evalDoubleUnary' ts []

evalUnary' :: [Token] -> [Token] -> [Token]
evalUnary' [] as = reverse as

evalUnary' (Operator op:Operator '-':Num y:ts) as = evalUnary' ts (Num (-y):Operator op:as)
evalUnary' (Operator op:Operator '+':Num y:ts) as = evalUnary' ts (Num y:Operator op:as)

evalUnary' (OpenBracket:Operator '-':Num y:ts) as = evalUnary' ts (Num (-y):OpenBracket:as)
evalUnary' (OpenBracket:Operator '+':Num y:ts) as = evalUnary' ts (Num y:OpenBracket:as)

evalUnary' (t:ts) as = evalUnary' ts (t:as)

evalUnary  :: [Token] -> [Token]
evalUnary ts = evalUnary' ts []

evalBrackets' :: [Token] -> [Token] -> [Token]

evalBrackets' [] as = reverse as

evalBrackets' (OpenBracket:ts) as = 
    let ts' = evalBrackets ts
    in evalBrackets' ts' as

evalBrackets' (CloseBracket:ts) as = 
    let r = eval $ reverse as
    in Num r:ts 

evalBrackets' (t:ts) as = evalBrackets' ts (t:as)

evalBrackets  :: [Token] -> [Token]
evalBrackets ts = evalBrackets' ts []

eval :: [Token] -> Integer
eval ts = 
    let ts' = evalMulDiv (reverse ts) []
        res = evalPlusMinus $ reverse ts'
    in if res > 0 then res `mod` p else if (-res) > p then -((-res) `mod` p) else p - (-1 * res) `mod` p


mulDiv :: [Token] -> [[Token]] -> [Token]
mulDiv [] [ys] = reverse ys

mulDiv ts [] = mulDiv ts [[]]

mulDiv (Operator op : CloseBracket : ts) (ys:yss) = 
    mulDiv ts ([]:[Operator op, Num (evalPlusMinus ys)]:yss)
        
mulDiv (Num x : Operator '-' : OpenBracket : ts) (ys:yss) = 
    mulDiv (Num (-x) : OpenBracket : ts) (ys:yss) 

mulDiv (Num x : OpenBracket : ts) (ys:yss) = 
    mulDiv ts ([Num (evalPlusMinus (Num x:ys))]:yss)

mulDiv (CloseBracket : ts) yss = mulDiv ts ([]:yss)


mulDiv (Num x : Operator '-' : Operator op : ts) yss = mulDiv (Num (-x): Operator op: ts) yss
mulDiv (Num x : Operator '+' : Operator op : ts) yss = mulDiv (Num x: Operator op: ts) yss

mulDiv (Num x : Operator '-' : Num y: ts) (ys:yss) = mulDiv (Num y : ts) ((Num x : Operator '-' :ys):yss)
mulDiv (Num x : Operator '+' : Num y: ts) (ys:yss) = mulDiv (Num y : ts) ((Num x : Operator '+' :ys):yss)

mulDiv (Num x : Operator '*' : Num y : Operator op: ts) yss = mulDiv (Num (x * y) : Operator op : ts) yss
mulDiv (Num x : Operator '/' : Num y : Operator op: ts) yss = mulDiv (Num (modDiv x y) : Operator op : ts) yss



mulDiv (t:ts) (ys:yss) = mulDiv ts ((t:ys):yss)

mulDiv _ _ = error "Error in mulDiv"


-- mulDiv (CloseBracket : Num x : Operator '-' : Operator '*': Num y: Operator '-' : xs) ys =
--     mulDiv (CloseBracket : Num (x * y) : xs) ys
-- mulDiv (CloseBracket : Num x : Operator '+' : Operator '*': Num y: Operator '+' : xs) ys =
--     mulDiv (CloseBracket : Num (x * y) : xs) ys
-- mulDiv (CloseBracket : Num x : Operator '-' : Operator '*': Num y: Operator '+' : xs) ys =
--     mulDiv (CloseBracket : Num (x * (-y)) : xs) ys
-- mulDiv (CloseBracket : Num x : Operator '-' : Operator '*': Num y: xs) ys =
--     mulDiv (CloseBracket : Num (x * (-y)) : xs) ys
-- mulDiv (CloseBracket : Num x : Operator '*': Num y: Operator '-' : xs) ys =
--     mulDiv (CloseBracket : Num (x * (-y)) : xs) ys

-- mulDiv (CloseBracket : Num x : Operator '-' : Operator '/': Num y: Operator '-' : xs) ys =
--     mulDiv (CloseBracket : Num (modDiv x y) : xs) ys
-- mulDiv (CloseBracket : Num x : Operator '+' : Operator '/': Num y: Operator '+' : xs) ys =
--     mulDiv (CloseBracket : Num (modDiv x y) : xs) ys
-- mulDiv (CloseBracket : Num x : Operator '-' : Operator '/': Num y: Operator '+' : xs) ys =
--     mulDiv (CloseBracket : Num (modDiv x (-y)) : xs) ys
-- mulDiv (CloseBracket : Num x : Operator '-' : Operator '/': Num y: xs) ys =
--     mulDiv (CloseBracket : Num (modDiv (-x) y) : xs) ys
-- mulDiv (CloseBracket : Num x : Operator '/': Num y: Operator '-' : xs) ys =
--     mulDiv (CloseBracket : Num (modDiv x (-y)) : xs) ys


doEvalSimple :: [Token] -> [[Token]] -> Integer -> IO Integer

doEvalSimple [Num n] [] 0 = return n

doEvalSimple (Num n : Operator op : CloseBracket: tt) xss bc = 
    case xss of
        [] -> doEvalSimple (CloseBracket: tt) [[Operator op, Num n]] bc
        [xs] -> doEvalSimple (CloseBracket: tt) [Operator op: Num n : xs] bc
        ys:yss -> doEvalSimple (CloseBracket: tt) ((Operator op: Num n : ys):yss) bc

doEvalSimple (CloseBracket: tt) xss bc = 
    doEvalSimple tt ([]:xss) (bc+1)

doEvalSimple [OpenBracket] [xs] 1 = 
    doEvalSimple (reverse xs) [] 0

doEvalSimple (OpenBracket: tt) [xs] bc = 
    doEvalSimple (reverse xs ++ tt) [] (bc-1)

doEvalSimple (OpenBracket: tt) (xs:ys:xss) bc = do
    putStrLn "Here!"
    

    print $ reverse $ reverse ys ++ reverse xs 
    
    print $ take 30 tt


    doEvalSimple (reverse ys ++ reverse xs ++ tt) xss (bc-1)

    -- putStrLn "Result : "
    -- print n
    -- doEvalSimple tt ((Num n:ys):xss) (bc-1)

doEvalSimple (Num n : Operator op : OpenBracket : tt) [] bc = 
    doEvalSimple (Num n : Operator op : tt) [] bc

doEvalSimple (Num n : Operator op : OpenBracket : tt) [[]] bc = 
    doEvalSimple (OpenBracket : tt) [[Operator op, Num n]] bc

doEvalSimple (Num n : Operator op : OpenBracket : tt) (xs:xss) bc = 
    doEvalSimple (OpenBracket : tt) ((Operator op : Num n : xs) : xss) bc

doEvalSimple (Num n : Operator '-' : Operator op : Num n2 : Operator '-': Operator op2: tt) tss bc = 
    doEvalSimple (Num (-n) : Operator op: Num (-n2) : Operator op2: tt) tss bc    

doEvalSimple (Num n2 : Operator '+' : Num n1 : Operator '-' : Operator op2 : tt) tss bc = 
    doEvalSimple (Num (-n1+n2) : Operator op2 : tt) tss bc    

doEvalSimple (Num n2 : Operator '-' : Num n1 : Operator '-' : Operator op2 : tt) tss bc = 
    doEvalSimple (Num (-n1-n2) : Operator op2 : tt) tss bc    

doEvalSimple (Num n2 : Operator '*' : Num n1 : Operator '-' : Operator op2 : tt) tss bc = 
    doEvalSimple (Num (-n1*n2) : Operator op2 : tt) tss bc    

doEvalSimple (Num n2 : Operator '/' : Num n1 : Operator '-' : Operator op2 : tt) tss bc = 
    doEvalSimple (Num (modDiv (-n1) n2) : Operator op2 : tt) tss bc    

-- doEvalSimple (Num n : Operator op : Num n2 : Operator '-' : Operator op2 : tt) tss bc = 
--     doEvalSimple (Num n : Operator op: Num (-n2) : Operator op2 : tt) tss bc    

doEvalSimple (Num y : Operator '*' : Num x : Operator op : tt) tss bc = 
    doEvalSimple (Num (x * y) : Operator op : tt) tss bc

doEvalSimple (Num y : Operator '/' : Num x : Operator op : tt) tss bc = 
    doEvalSimple (Num (modDiv x y) : Operator op : tt) tss bc

doEvalSimple (Num n : Operator '+' : Num n2 : Operator op: tt) tss bc = 
    doEvalSimple tt (if null tss then  [[Num (n+n2)]] else (Operator op : Num (n+n2) : head tss) :tail tss) bc

doEvalSimple (Num n : Operator '-' : Num n2 : Operator op: tt) tss bc = 
    doEvalSimple tt (if null tss then  [[Num (n2-n)]] else (Operator op : Num (n2-n) : head tss) :tail tss) bc

doEvalSimple ts xss bc = do
    
    putStrLn "Bracket count:"
    print bc
    
    putStrLn "Remaining tokens:"
    print (take 10 ts) 
    
    putStrLn "Accumulated:"
    print xss 
    error "Unexpected token sequence:"

evalSimple :: [Token] -> IO Integer
evalSimple ts =
    doEvalSimple ts [] 0



main :: IO()
main = do
    --ex <- getLine
    -- print $ length $ tokenize ex []
    -- print $ length $ evalDoubleUnary $ tokenize ex [] 
    let uts = tokenize ex []
--evalUnary $ evalDoubleUnary
    -- mapM_ (putStr . show) $ reverse $ take 100 uts

    putStrLn ""

    n <- evalSimple uts

    print n

    -- let bts = evalBrackets uts
    -- let res = eval bts
    -- print res

